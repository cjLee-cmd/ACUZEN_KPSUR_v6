<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ê³ ì„œ ëª©ë¡ - KPSUR AGENT | ACUZEN AI</title>
    <link rel="stylesheet" href="../css/styles/globals.css">
    <link rel="stylesheet" href="../css/styles/layout.css">
    <style>
        .page-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
        }

        .page-title-section h1 {
            font-size: 24px;
            font-weight: 700;
            color: #374151;
            margin-bottom: var(--spacing-xs);
        }

        .page-subtitle {
            font-size: 13px;
            color: #6B7280;
        }

        .header-actions {
            display: flex;
            gap: var(--spacing-md);
        }

        .btn-primary {
            padding: var(--spacing-md) var(--spacing-xl);
            background: linear-gradient(135deg, #25739B 0%, #369EE1 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(37, 115, 155, 0.3);
        }

        /* í•„í„° ì„¹ì…˜ */
        .filter-section {
            background: white;
            border-radius: 12px;
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .filter-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: #6B7280;
        }

        .filter-input, .filter-select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 2px solid #E5E7EB;
            border-radius: 6px;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .filter-input:focus, .filter-select:focus {
            border-color: #25739B;
            outline: none;
        }

        .filter-chips {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid #E5E7EB;
            background: white;
            color: #6B7280;
        }

        .filter-chip:hover {
            border-color: #25739B;
            color: #25739B;
        }

        .filter-chip.active {
            background: linear-gradient(135deg, #25739B 0%, #369EE1 100%);
            color: white;
            border-color: transparent;
        }

        .filter-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .btn-filter {
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-apply {
            background: #25739B;
            color: white;
        }

        .btn-reset {
            background: #E5E7EB;
            color: #6B7280;
        }

        /* í…Œì´ë¸” ì»¨í…Œì´ë„ˆ */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            border-bottom: 2px solid #E5E7EB;
        }

        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }

        .table-count {
            font-size: 13px;
            color: #6B7280;
        }

        .table-actions {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .view-toggle {
            display: flex;
            gap: 4px;
            background: #F3F4F6;
            padding: 4px;
            border-radius: 6px;
        }

        .view-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .view-btn.active {
            background: white;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* í…Œì´ë¸” */
        .reports-table {
            width: 100%;
            border-collapse: collapse;
        }

        .reports-table th {
            text-align: left;
            font-size: 11px;
            font-weight: 600;
            color: #6B7280;
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid #E5E7EB;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: #F9FAFB;
            position: sticky;
            top: 0;
        }

        .reports-table th.sortable {
            cursor: pointer;
            user-select: none;
        }

        .reports-table th.sortable:hover {
            color: #25739B;
        }

        .sort-icon {
            margin-left: 4px;
            font-size: 10px;
            color: #D1D5DB;
        }

        .sort-icon.active {
            color: #25739B;
        }

        .reports-table td {
            padding: var(--spacing-lg);
            border-bottom: 1px solid #F3F4F6;
            font-size: 13px;
            color: #374151;
        }

        .reports-table tr:hover {
            background: rgba(37, 115, 155, 0.02);
        }

        .report-name {
            font-weight: 600;
            color: #25739B;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .report-name:hover {
            text-decoration: underline;
        }

        .urgent-badge {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #EF4444;
            animation: pulse 2s ease-in-out infinite;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-badge.draft {
            background: rgba(156, 163, 175, 0.1);
            color: #6B7280;
        }

        .status-badge.in-progress {
            background: rgba(59, 130, 246, 0.1);
            color: #3B82F6;
        }

        .status-badge.review {
            background: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }

        .status-badge.qc {
            background: rgba(168, 85, 247, 0.1);
            color: #A855F7;
        }

        .status-badge.completed {
            background: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }

        .stage-text {
            font-size: 11px;
            color: #9CA3AF;
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-sm);
        }

        .action-btn {
            padding: 4px 8px;
            border-radius: 4px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: rgba(37, 115, 155, 0.1);
        }

        /* í˜ì´ì§€ë„¤ì´ì…˜ */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            border-top: 1px solid #E5E7EB;
        }

        .pagination-info {
            font-size: 13px;
            color: #6B7280;
        }

        .pagination-controls {
            display: flex;
            gap: var(--spacing-sm);
        }

        .page-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid #E5E7EB;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .page-btn:hover:not(:disabled) {
            border-color: #25739B;
            color: #25739B;
        }

        .page-btn.active {
            background: #25739B;
            color: white;
            border-color: #25739B;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .filter-row {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .reports-table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <span class="logo-text">KPSUR AGENT</span>
                    <span class="logo-subtitle">ACUZEN AI</span>
                </div>
                <span class="deployment-badge test">í…ŒìŠ¤íŠ¸</span>
            </div>

            <div class="header-center">
                <div class="breadcrumb">
                    <span class="breadcrumb-item" onclick="navigateTo('P10_Dashboard.html')" style="cursor: pointer;">ëŒ€ì‹œë³´ë“œ</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item active">ë³´ê³ ì„œ ëª©ë¡</span>
                </div>
            </div>

            <div class="header-right">
                <div class="user-menu">
                    <div class="user-avatar">ì‚¬</div>
                    <div class="user-info">
                        <div class="user-name">ì‚¬ìš©ì</div>
                        <div class="user-role">Author</div>
                    </div>
                    <button class="user-menu-toggle">â–¼</button>
                </div>
            </div>
        </header>

        <!-- Content with Sidebar -->
        <div class="app-content">
            <!-- Main Content -->
            <main class="main-content">
                <div class="page-container">
                    <!-- Page Header -->
                    <div class="page-header">
                        <div class="page-title-section">
                            <h1>ë³´ê³ ì„œ ëª©ë¡</h1>
                            <p class="page-subtitle">ì „ì²´ PSUR ë³´ê³ ì„œë¥¼ í™•ì¸í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                        </div>

                        <div class="header-actions">
                            <button class="btn-primary" onclick="navigateTo('P13_NewReport.html')">
                                <span>â•</span>
                                <span>ìƒˆ ë³´ê³ ì„œ ìƒì„±</span>
                            </button>
                        </div>
                    </div>

                    <!-- í•„í„° ì„¹ì…˜ -->
                    <div class="filter-section">
                        <div class="filter-row" style="margin-bottom: var(--spacing-md);">
                            <div class="filter-group">
                                <label class="filter-label">ê²€ìƒ‰</label>
                                <input
                                    type="text"
                                    class="filter-input"
                                    placeholder="ë³´ê³ ì„œëª…, ì„±ë¶„ëª… ê²€ìƒ‰..."
                                    id="searchInput"
                                >
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">ì‘ì„±ì</label>
                                <select class="filter-select" id="authorFilter">
                                    <option value="">ì „ì²´</option>
                                    <option value="ê¹€ì² ìˆ˜">ê¹€ì² ìˆ˜</option>
                                    <option value="ì´ì˜í¬">ì´ì˜í¬</option>
                                    <option value="ë°•ë¯¼ìˆ˜">ë°•ë¯¼ìˆ˜</option>
                                    <option value="ìµœì§€ì˜">ìµœì§€ì˜</option>
                                    <option value="ì •ìˆ˜ë¹ˆ">ì •ìˆ˜ë¹ˆ</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">ê¸°ê°„</label>
                                <select class="filter-select" id="periodFilter">
                                    <option value="">ì „ì²´</option>
                                    <option value="today">ì˜¤ëŠ˜</option>
                                    <option value="week">ìµœê·¼ 1ì£¼ì¼</option>
                                    <option value="month">ìµœê·¼ 1ê°œì›”</option>
                                    <option value="quarter">ìµœê·¼ 3ê°œì›”</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">ë‹¨ê³„</label>
                                <select class="filter-select" id="stageFilter">
                                    <option value="">ì „ì²´</option>
                                    <option value="2">Stage 2 - ë³´ê³ ì„œ ìƒíƒœ</option>
                                    <option value="3">Stage 3 - íŒŒì¼ ì—…ë¡œë“œ</option>
                                    <option value="4">Stage 4 - MD ë³€í™˜</option>
                                    <option value="5">Stage 5 - ë°ì´í„° ì¶”ì¶œ</option>
                                    <option value="6">Stage 6 - í…œí”Œë¦¿ ì‘ì„±</option>
                                    <option value="7">Stage 7 - ë¦¬ë·°</option>
                                    <option value="8">Stage 8 - QC ê²€ì¦</option>
                                    <option value="9">Stage 9 - ìµœì¢… ì¶œë ¥</option>
                                </select>
                            </div>
                        </div>

                        <div class="filter-row" style="margin-bottom: var(--spacing-md);">
                            <div class="filter-group">
                                <label class="filter-label">ìƒíƒœ</label>
                                <div class="filter-chips">
                                    <div class="filter-chip active" data-status="">ì „ì²´</div>
                                    <div class="filter-chip" data-status="draft">ì„ì‹œì €ì¥</div>
                                    <div class="filter-chip" data-status="in-progress">ì§„í–‰ì¤‘</div>
                                    <div class="filter-chip" data-status="review">ë¦¬ë·°ì¤‘</div>
                                    <div class="filter-chip" data-status="qc">QCëŒ€ê¸°</div>
                                    <div class="filter-chip" data-status="completed">ì™„ë£Œ</div>
                                </div>
                            </div>
                        </div>

                        <div class="filter-row">
                            <div class="filter-actions">
                                <button class="btn-filter btn-apply" onclick="applyFilters()">ì ìš©</button>
                                <button class="btn-filter btn-reset" onclick="resetFilters()">ì´ˆê¸°í™”</button>
                            </div>
                        </div>
                    </div>

                    <!-- í…Œì´ë¸” -->
                    <div class="table-container">
                        <div class="table-header">
                            <div>
                                <div class="table-title">ì „ì²´ ë³´ê³ ì„œ</div>
                                <div class="table-count" id="tableCount">ì´ 18ê°œ ë³´ê³ ì„œ</div>
                            </div>

                            <div class="table-actions">
                                <div class="view-toggle">
                                    <button class="view-btn active">ëª©ë¡</button>
                                    <button class="view-btn">ì¹´ë“œ</button>
                                </div>
                            </div>
                        </div>

                        <table class="reports-table">
                            <thead>
                                <tr>
                                    <th class="sortable" onclick="sortTable('name')">
                                        ë³´ê³ ì„œëª…
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th class="sortable" onclick="sortTable('ingredient')">
                                        ì„±ë¶„ëª…
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th class="sortable" onclick="sortTable('stage')">
                                        ë‹¨ê³„
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th class="sortable" onclick="sortTable('status')">
                                        ìƒíƒœ
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th class="sortable" onclick="sortTable('author')">
                                        ì‘ì„±ì
                                        <span class="sort-icon">â†•</span>
                                    </th>
                                    <th class="sortable" onclick="sortTable('date')">
                                        ìˆ˜ì •ì¼
                                        <span class="sort-icon active">â†“</span>
                                    </th>
                                    <th>ì‘ì—…</th>
                                </tr>
                            </thead>
                            <tbody id="reportsTableBody">
                                <!-- ìƒ˜í”Œ ë°ì´í„° -->
                            </tbody>
                        </table>

                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div class="pagination">
                            <div class="pagination-info">
                                <span id="paginationInfo">1-10 / 18ê°œ ë³´ê³ ì„œ</span>
                            </div>

                            <div class="pagination-controls">
                                <button class="page-btn" disabled>â€¹ ì´ì „</button>
                                <button class="page-btn active">1</button>
                                <button class="page-btn">2</button>
                                <button class="page-btn">ë‹¤ìŒ â€º</button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Workflow Sidebar (Right) -->
            <aside class="workflow-sidebar">
                <div class="workflow-header">
                    <h3>ì§„í–‰ ìƒí™©</h3>
                    <div class="workflow-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">ë³´ê³ ì„œ ëª©ë¡</div>
                    </div>
                </div>

                <div class="workflow-stages">
                    <div class="workflow-stage completed">
                        <div class="stage-icon">ğŸ”</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 1</div>
                            <div class="stage-label">ë¡œê·¸ì¸</div>
                        </div>
                        <div class="stage-status">âœ“</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">ğŸ“‹</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 2</div>
                            <div class="stage-label">ë³´ê³ ì„œ ìƒíƒœ</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">ğŸ“¤</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 3</div>
                            <div class="stage-label">íŒŒì¼ ì—…ë¡œë“œ</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">ğŸ”„</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 4</div>
                            <div class="stage-label">MD ë³€í™˜</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">âš™ï¸</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 5</div>
                            <div class="stage-label">ë°ì´í„° ì¶”ì¶œ</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">ğŸ“„</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 6</div>
                            <div class="stage-label">í…œí”Œë¦¿ ì‘ì„±</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">âœï¸</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 7</div>
                            <div class="stage-label">ë¦¬ë·°</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">âœ…</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 8</div>
                            <div class="stage-label">QC ê²€ì¦</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>

                    <div class="workflow-stage pending">
                        <div class="stage-icon">ğŸ“¤</div>
                        <div class="stage-info">
                            <div class="stage-name">Stage 9</div>
                            <div class="stage-label">ìµœì¢… ì¶œë ¥</div>
                        </div>
                        <div class="stage-status">â—‹</div>
                    </div>
                </div>

                <div class="workflow-footer">
                    <div class="medical-badge">ì˜ë£Œìš© AI ì†Œí”„íŠ¸ì›¨ì–´</div>
                </div>
            </aside>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                Copyright. Power Solution., Inc. 2026.
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../components/AppLayout.js"></script>
    <script src="../utils/layout-helper.js"></script>
    <script>
        // ìƒ˜í”Œ ë°ì´í„°
        const sampleReports = [
            { id: 1, name: 'ì½”ë¡œë‚˜19ë°±ì‹ _PSUR_2024Q4', ingredient: 'í† ì§€ë‚˜ë©”ë€', stage: 7, status: 'review', author: 'ê¹€ì² ìˆ˜', date: '2025-12-28', urgent: true },
            { id: 2, name: 'ê³ í˜ˆì••ì•½_PSUR_2024Q4', ingredient: 'ì•”ë¡œë””í•€', stage: 8, status: 'qc', author: 'ì´ì˜í¬', date: '2025-12-27', urgent: true },
            { id: 3, name: 'ë‹¹ë‡¨ë³‘ì•½_PSUR_2024Q4', ingredient: 'ë©”íŠ¸í¬ë¥´ë¯¼', stage: 5, status: 'in-progress', author: 'ë°•ë¯¼ìˆ˜', date: '2025-12-26', urgent: false },
            { id: 4, name: 'í•­ìƒì œ_PSUR_2024Q3', ingredient: 'ì•„ëª©ì‹œì‹¤ë¦°', stage: 9, status: 'completed', author: 'ìµœì§€ì˜', date: '2025-12-20', urgent: false },
            { id: 5, name: 'ì§„í†µì œ_PSUR_2024Q4', ingredient: 'ì´ë¶€í”„ë¡œíœ', stage: 2, status: 'draft', author: 'ì •ìˆ˜ë¹ˆ', date: '2025-12-25', urgent: false },
            { id: 6, name: 'í•­ì•Œë ˆë¥´ê¸°ì•½_PSUR_2024Q4', ingredient: 'ì„¸í‹°ë¦¬ì§„', stage: 6, status: 'in-progress', author: 'ê¹€ì² ìˆ˜', date: '2025-12-24', urgent: false },
            { id: 7, name: 'ì†Œí™”ì œ_PSUR_2024Q4', ingredient: 'íŒí¬ë ˆì•„í‹´', stage: 4, status: 'in-progress', author: 'ì´ì˜í¬', date: '2025-12-23', urgent: false },
            { id: 8, name: 'ì‹¬í˜ˆê´€ì•½_PSUR_2024Q3', ingredient: 'ì•„í† ë¥´ë°”ìŠ¤íƒ€í‹´', stage: 9, status: 'completed', author: 'ë°•ë¯¼ìˆ˜', date: '2025-12-15', urgent: false },
            { id: 9, name: 'í˜¸í¡ê¸°ì•½_PSUR_2024Q4', ingredient: 'ì‚´ë¶€íƒ€ëª°', stage: 7, status: 'review', author: 'ìµœì§€ì˜', date: '2025-12-22', urgent: false },
            { id: 10, name: 'í”¼ë¶€ì•½_PSUR_2024Q4', ingredient: 'í•˜ì´ë“œë¡œì½”ë¥´í‹°ì†', stage: 3, status: 'in-progress', author: 'ì •ìˆ˜ë¹ˆ', date: '2025-12-21', urgent: false }
        ];

        let currentReports = [...sampleReports];

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        // Wait for both DOM and globals to load
        function initializePage() {
            // Check if globals are loaded
            if (!window.__GLOBALS_LOADED__) {
                setTimeout(initializePage, 50);
                return;
            }

            const session = loadSessionData();
            if (session) {
                document.querySelector('.user-name').textContent = session.userName;
                document.querySelector('.user-role').textContent = session.userRole;
                document.querySelector('.user-avatar').textContent = session.userName.charAt(0);
            }

            setupUserMenu();
            setupFilterChips();
            renderReports();

            // URL íŒŒë¼ë¯¸í„°ì—ì„œ í•„í„° í™•ì¸
            const urlParams = new URLSearchParams(window.location.search);
            const filter = urlParams.get('filter');
            if (filter && filter !== 'all') {
                const chip = document.querySelector(`[data-status="${filter}"]`);
                if (chip) {
                    document.querySelector('.filter-chip.active').classList.remove('active');
                    chip.classList.add('active');
                    applyFilters();
                }
            }
        }

        // Start initialization when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
        } else {
            initializePage();
        }

        function setupFilterChips() {
            const chips = document.querySelectorAll('.filter-chip');
            chips.forEach(chip => {
                chip.addEventListener('click', () => {
                    document.querySelector('.filter-chip.active').classList.remove('active');
                    chip.classList.add('active');
                    applyFilters();
                });
            });
        }

        function renderReports() {
            const tbody = document.getElementById('reportsTableBody');
            tbody.innerHTML = '';

            currentReports.forEach(report => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <div class="report-name" onclick="navigateTo('P12_ReportDetail.html?id=${report.id}')">
                            ${report.urgent ? '<span class="urgent-badge"></span>' : ''}
                            ${report.name}
                        </div>
                    </td>
                    <td>${report.ingredient}</td>
                    <td><span class="stage-text">Stage ${report.stage} - ${getStageName(report.stage)}</span></td>
                    <td><span class="status-badge ${report.status}">${getStatusText(report.status)}</span></td>
                    <td>${report.author}</td>
                    <td>${report.date}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn" onclick="viewReport(${report.id})" title="ë³´ê¸°">ğŸ‘ï¸</button>
                            <button class="action-btn" onclick="editReport(${report.id})" title="í¸ì§‘">âœï¸</button>
                            <button class="action-btn" onclick="deleteReport(${report.id})" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            updateTableCount();
        }

        function getStageName(stage) {
            const stages = {
                2: 'ë³´ê³ ì„œ ìƒíƒœ',
                3: 'íŒŒì¼ ì—…ë¡œë“œ',
                4: 'MD ë³€í™˜',
                5: 'ë°ì´í„° ì¶”ì¶œ',
                6: 'í…œí”Œë¦¿ ì‘ì„±',
                7: 'ë¦¬ë·°',
                8: 'QC ê²€ì¦',
                9: 'ìµœì¢… ì¶œë ¥'
            };
            return stages[stage] || '';
        }

        function getStatusText(status) {
            const texts = {
                'draft': 'ì„ì‹œì €ì¥',
                'in-progress': 'ì§„í–‰ì¤‘',
                'review': 'ë¦¬ë·°ì¤‘',
                'qc': 'QCëŒ€ê¸°',
                'completed': 'ì™„ë£Œ'
            };
            return texts[status] || status;
        }

        function updateTableCount() {
            document.getElementById('tableCount').textContent = `ì´ ${currentReports.length}ê°œ ë³´ê³ ì„œ`;
            document.getElementById('paginationInfo').textContent = `1-${Math.min(10, currentReports.length)} / ${currentReports.length}ê°œ ë³´ê³ ì„œ`;
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const author = document.getElementById('authorFilter').value;
            const stage = document.getElementById('stageFilter').value;
            const status = document.querySelector('.filter-chip.active').dataset.status;

            currentReports = sampleReports.filter(report => {
                const matchesSearch = !searchTerm ||
                    report.name.toLowerCase().includes(searchTerm) ||
                    report.ingredient.toLowerCase().includes(searchTerm);
                const matchesAuthor = !author || report.author === author;
                const matchesStage = !stage || report.stage.toString() === stage;
                const matchesStatus = !status || report.status === status;

                return matchesSearch && matchesAuthor && matchesStage && matchesStatus;
            });

            renderReports();
            showToast('í•„í„°ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('authorFilter').value = '';
            document.getElementById('periodFilter').value = '';
            document.getElementById('stageFilter').value = '';

            document.querySelector('.filter-chip.active').classList.remove('active');
            document.querySelector('.filter-chip[data-status=""]').classList.add('active');

            currentReports = [...sampleReports];
            renderReports();
            showToast('í•„í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }

        function sortTable(column) {
            // ì •ë ¬ êµ¬í˜„
            showToast('ì •ë ¬ ê¸°ëŠ¥ì€ ê³§ ì¶”ê°€ë©ë‹ˆë‹¤.', 'info');
        }

        function viewReport(id) {
            navigateTo(`P12_ReportDetail.html?id=${id}`);
        }

        function editReport(id) {
            navigateTo(`P12_ReportDetail.html?id=${id}&mode=edit`);
        }

        function deleteReport(id) {
            if (confirm('ì´ ë³´ê³ ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                showToast('ë³´ê³ ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                currentReports = currentReports.filter(r => r.id !== id);
                renderReports();
            }
        }
    </script>
    <script type="module" src="../utils/globals.js"></script>
</body>
</html>
